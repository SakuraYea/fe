<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title></title>
</head>
<body>
<a href="javascript:">btn1</a>
<a href="javascript:">btn2</a>
<a href="javascript:">btn3</a>
<a href="javascript:">btn4</a>
<script src="https://cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script>
<script type="text/javascript">
var registerForm = document.querySelector("#registerForm");
registerForm.onsubmit = function(e){
	e.preventDefault();
	var errorMsg = validataFunc();
	if (errorMsg) {
		alert(errorMsg);
		return false;
	}else{
		alert("校验通过")
	}
}
var strategies = {
	inNoEmpty:function(val,errorMsg){
		if (val === '') {
			return errorMsg;
		}
	},
	minLength:function(val,length,errorMsg){
		if (val.length < length) {
			return errorMsg;
		}
	},
	isMobile:function(val,errorMsg){
		if (!/(^1[3|5|8][0-9]{9}$)/.test(val)) {
			return errorMsg;
		}
	}
};
var Validator = function(){
	this.cache = [];
};
Validator.prototype.add = function(dom,rules){
	var self = this;
	for (var i = 0, rule; rule = rules[i++];) {
		(function(rule){
			var strategyAry = rule.strategy.split(':');
			var errorMsg = rule.errorMsg;
			self.cache.push(function(){
				var strategy = strategyAry.shift();
				strategyAry.unshift(dom.value);
				strategyAry.push(errorMsg);
				return strategies[strategy].apply(dom,strategyAry);
			});
		})(rule)
	}
};
Validator.prototype.start = function(){
	for (var i = 0,validataFunc; validataFunc = this.cache[i++];) {
		var msg = validataFunc();
		if (msg) {
			return msg;
		}
	}
};
var validataFunc = function(){
	var validator = new Validator();
	validator.add(registerForm.username,[{
		strategy:'isNoEmpty',
		errorMsg:'用户名不能为空'
	},{
		strategy:'minLength:10',
		errorMsg:'用户名长度不能小于10'
	}]);
	validator.add(registerForm.password,[{
		strategy:'isNoEmpty',
		errorMsg:'密码不能为空'
	},{
		strategy:'minLength:6',
		errorMsg:'密码长度不能小于6'
	}]);
	validator.add(registerForm.phone,[{
		strategy:'isNoEmpty',
		errorMsg:'手机号不能为空'
	},{
		strategy:'isMobile',
		errorMsg:'手机号不能为空'
	}]);
	var errorMsg = validator.start();
	return errorMsg;
};
// $(function(){
//     console.log($("a").get(0));
//     console.log($("a").eq(0));
//     $("a").get(0).click(function(){
//         console.log("111");
//     })
// });
var func = function(){
  var a = 1;
  return function(){
    a++;
    alert(a);
  }
}
var f = func();
f();
f();
var strategies = {
	isNonEmpty: function( value, errorMsg ){
		if ( value === '' ){
			return errorMsg;
		}
	},
	minLength: function( value, length, errorMsg ){
		if ( value.length < length ){
			return errorMsg;
		}
	},
	isMobile: function( value, errorMsg ){
		if ( !/(^1[3|5|8][0-9]{9}$)/.test( value ) ){
			return errorMsg;
		}
	}
};
var Validator = function(){
	this.cache = [];
};
Validator.prototype.add = function( dom, rules ){
	var self = this;
	for ( var i = 0, rule; rule = rules[ i++ ]; ){
		(function( rule ){
			var strategyAry = rule.strategy.split( ':' );
			var errorMsg = rule.errorMsg;
			self.cache.push(function(){
				var strategy = strategyAry.shift();
				strategyAry.unshift( dom.value );
				strategyAry.push( errorMsg );
				return strategies[ strategy ].apply( dom, strategyAry );
			});
		})( rule )
	}
};
Validator.prototype.start = function(){
	for ( var i = 0, validatorFunc; validatorFunc = this.cache[ i++ ]; ){
		var errorMsg = validatorFunc();
		if ( errorMsg ){
			return errorMsg;
		}
	}
}
var validataFunc = function(){
	var validator = new Validator();
	validator.add( registerForm.username, [{
		strategy: 'isNonEmpty',
		errorMsg: '用户名不能为空'
	}, {
		strategy: 'minLength:6',
		errorMsg: '用户名长度不能小于10 位'
	}]);
	validator.add( registerForm.password, [{
		strategy: 'minLength:6',
		errorMsg: '密码长度不能小于6 位'
	}]);
	validator.add( registerForm.phone, [{
		strategy: 'isMobile',
		errorMsg: '手机格式不正确'
	}]);
	var errorMsg = validator.start();
	return errorMsg;
}
var registerForm = document.querySelector("#registerForm");
registerForm.onsubmit = function(e){
	e.preventDefault();
	var errorMsg = validataFunc();
	if (errorMsg) {
		alert(errorMsg);
		return false;
	}else{
		alert("校验通过")
	}
}	
	
</script>
</body>
</html>
